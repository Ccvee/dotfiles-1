#!/usr/bin/env bash

__dotfiles_dir="${HOME}/.dotfiles"
. "${__dotfiles_dir}/lib/helpers.sh"
. "${__dotfiles_dir}/lib/pretty.bash"

# $1 source file path
# $2 dest file path
# return success if fulltargetpath is resolvedpath
__dko_same() {
  local sourcepath="$1"
  local targetpath="$2"

  if ! __dko_has "realpath"; then
    __dko_err "Missing realpath command (e.g. brew install coreutils)"
    return 1
  fi

  if [[ -f "$targetpath" ]] || [[ -d "$targetpath" ]]; then
    local resolvedpath
    resolvedpath=$(realpath "$targetpath")
    if [[ "$resolvedpath" == "$sourcepath" ]]; then
      __dko_ok "${targetpath} is correct."
      return 0
    else
      __dko_warn "${targetpath} is not ${resolvedpath}."
      return 1
    fi
  fi

  # does not exist
  __dko_ok "${targetpath} does not exist"
  return 2
}

__dko_same "$@"
