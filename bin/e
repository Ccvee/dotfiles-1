#!/usr/bin/env bash

_e() {
  # ssh'ed or no X
  [ -n "$SSH_CONNECTION" ] && return vim "${@}"
  [ "$DOTFILES_OS" == "Linux" ] && [ -z "$DISPLAY" ] && return vim "${@}"

  # has filenames
  if [ $# -ne 0 ]; then
    # remote silent will FG the vim server
    gvim --servername GVIM --remote-silent "${@}"

  # bring gvim server to FG if has an existing instance and no files
  elif gvim --serverlist | grep GVIM > /dev/null; then
    gvim --servername GVIM --remote-send ":call foreground()<CR>"

  else
    gvim --servername GVIM

  fi

  exit 0
}

_e "${@}"

